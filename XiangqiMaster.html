<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Xiangqi Master: Universal</title>
    <style>
      :root {
        --bg-color: #f4f4f4;
        --board-bg: #fdf5e6;
        --line-color: #4b3621;
        --red-ink: #c0392b;
        --black-ink: #2d3436;

        --panel-bg: #ffffff;
        --border-color: #d9d9d9;
        --highlight: rgba(255, 215, 0, 0.4);
        --selected: rgba(24, 144, 255, 0.4);
        --tab-active: #2c3e50;
        --branch-btn: #8e44ad;

        --piece-shadow: 1px 2px 4px rgba(0, 0, 0, 0.2);
      }

      body {
        margin: 0;
        background: var(--bg-color);
        color: #333;
        font-family: "Adobe Source Han Sans", "Noto Sans CJK", "Microsoft YaHei",
          sans-serif;
        height: 100dvh;
        width: 100vw;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        user-select: none;
        -webkit-user-select: none;
      }

      .container {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
        padding: 10px;
        box-sizing: border-box;
        gap: 10px;
        align-items: center;
        justify-content: center;
      }

      /* --- LANDSCAPE MODE (Desktop/iPad) --- */
      @media (min-width: 700px) and (orientation: landscape) {
        .container {
          flex-direction: row;
          max-width: 100%;
          padding: 10px;
          gap: 20px;
        }

        .board-frame {
          height: 96vh;
          width: auto;
          aspect-ratio: 9/10;
          max-height: none;
          max-width: none;
          margin: 0;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
          flex-shrink: 1;
        }

        .ui-panel {
          height: 96vh;
          width: 240px;
          flex: 0 0 240px;
          min-width: 240px;
        }

        .btn,
        .pb-btn,
        .tab {
          padding: 10px;
          font-size: 14px;
        }
      }

      /* --- PORTRAIT / MOBILE OPTIMIZATION --- */
      @media (orientation: portrait), (max-width: 699px) {
        .container {
          gap: 5px;
          padding: 5px;
        }

        .board-frame {
          width: 100%;
          aspect-ratio: 9/10;
          max-height: 68vh;
          max-width: 61.2vh;
          margin: 0 auto;
          flex-shrink: 0;
        }

        .ui-panel {
          width: 100%;
          flex: 1;
          min-height: 0;
        }

        /* FAT FINGER FRIENDLY BUTTONS */
        .btn,
        .pb-btn {
          padding: 15px 0 !important;
          font-size: 16px !important;
          margin-bottom: 2px;
        }
        .tab {
          padding: 14px;
          font-size: 15px;
        }
        .export-row select {
          padding: 12px;
          font-size: 16px;
        }
        .playback-bar {
          margin-bottom: 5px;
        }
        .tool-grid {
          gap: 8px;
        }
      }

      /* --- BOARD --- */
      .board-frame {
        position: relative;
        background-color: var(--board-bg);
        border: 2px solid #d4c5b0;
        border-radius: 4px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .board-inner {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      svg.grid {
        width: 100%;
        height: 100%;
        display: block;
        pointer-events: none;
      }

      .line {
        stroke: var(--line-color);
        stroke-width: 1.5;
        fill: none;
        vector-effect: non-scaling-stroke;
        stroke-linecap: round;
      }
      .border {
        stroke: var(--line-color);
        stroke-width: 4;
        fill: none;
        vector-effect: non-scaling-stroke;
      }

      /* Subtle Markers */
      .mark {
        stroke: var(--line-color);
        stroke-width: 1;
        fill: none;
        opacity: 0.6;
      }

      .river-text {
        font-family: "KaiTi", serif;
        font-size: 36px;
        fill: var(--line-color);
        opacity: 0.8;
        text-anchor: middle;
        dominant-baseline: middle;
        font-weight: bold;
        letter-spacing: 5px;
      }

      .layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
      .click-mask {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 100;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
      }

      /* --- PIECES --- */
      .piece {
        width: 11.1111%;
        height: 10%;
        position: absolute;
        z-index: 10;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: left 0.1s ease-out, top 0.1s ease-out;
      }

      .piece-inner {
        width: 90%;
        height: 90%;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #fff;
        border: 2px solid #a0a0a0;
        box-shadow: var(--piece-shadow);
        background-image: radial-gradient(
          circle at 30% 30%,
          #fff 0%,
          #f4f4f4 100%
        );
        position: relative;
      }

      .piece-inner::before {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        right: 3px;
        bottom: 3px;
        border-radius: 50%;
        border: 1px solid rgba(0, 0, 0, 0.08);
        pointer-events: none;
      }

      .piece-inner svg {
        width: 85%;
        height: 85%;
        display: block;
      }
      .piece.red .piece-inner {
        border-color: var(--red-ink);
      }
      .piece.black .piece-inner {
        border-color: var(--black-ink);
      }

      /* Markers */
      .marker {
        position: absolute;
        width: 11.1111%;
        height: 10%;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .last::after {
        content: "";
        width: 90%;
        height: 90%;
        border: 2px dashed #555;
        border-radius: 10px;
        opacity: 0.6;
      }
      .select::after {
        content: "";
        width: 90%;
        height: 90%;
        background: var(--selected);
        border-radius: 50%;
      }
      .dot::after {
        content: "";
        width: 18%;
        height: 18%;
        background: rgba(40, 167, 69, 0.6);
        border-radius: 50%;
      }

      /* --- UI PANEL --- */
      .ui-panel {
        display: flex;
        flex-direction: column;
        background: var(--panel-bg);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }

      .tabs {
        display: flex;
        background: #f5f5f5;
        border-bottom: 1px solid var(--border-color);
        flex-shrink: 0;
      }
      .tab {
        flex: 1;
        text-align: center;
        cursor: pointer;
        color: #666;
        transition: 0.2s;
        font-weight: bold;
      }
      .tab.active {
        background: #fff;
        color: var(--tab-active);
        border-bottom: 3px solid var(--tab-active);
      }

      .tab-content {
        flex: 1;
        display: none;
        flex-direction: column;
        padding: 10px;
        overflow: hidden;
        min-height: 0;
      }
      .tab-content.active {
        display: flex;
      }

      .playback-bar {
        display: flex;
        gap: 5px;
        margin-bottom: 10px;
        flex-shrink: 0;
      }
      .pb-btn {
        flex: 1;
        background: #fff;
        border: 1px solid #ccc;
        color: #444;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
      }
      .pb-btn:active {
        background: #e6e6e6;
      }

      .branch-ctrl {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-bottom: 8px;
        background: #f3e5f5;
        padding: 6px;
        border-radius: 4px;
        font-size: 13px;
        display: none;
        flex-shrink: 0;
        border: 1px solid #e1bee7;
      }
      .branch-ctrl.active {
        display: flex;
      }
      .branch-btn {
        background: #8e44ad;
        border: none;
        color: white;
        border-radius: 3px;
        padding: 4px 12px;
        cursor: pointer;
      }

      .status {
        text-align: center;
        margin-bottom: 8px;
        font-weight: bold;
        color: var(--red-ink);
        font-size: 15px;
        flex-shrink: 0;
      }

      .history {
        flex: 1;
        background: #fff;
        border-radius: 4px;
        border: 1px solid #eee;
        overflow-y: auto;
        padding: 5px;
        font-family: "Courier New", monospace;
        font-size: 14px;
      }
      .row {
        display: flex;
        padding: 5px;
        border-bottom: 1px solid #f0f0f0;
        color: #555;
      }
      .row:nth-child(even) {
        background: #fafafa;
      }
      .row.current {
        background: #e6f7ff;
        color: #000;
        border-left: 3px solid #1890ff;
      }
      .row span {
        flex: 1;
        cursor: pointer;
      }

      .tool-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        flex-shrink: 0;
      }
      .btn {
        border-radius: 4px;
        border: 1px solid rgba(0, 0, 0, 0.1);
        color: white;
        cursor: pointer;
        font-weight: bold;
      }
      .btn-norm {
        background: #6c757d;
      }
      .btn-red {
        background: #dc3545;
      }
      .btn-green {
        background: #28a745;
      }

      .export-row {
        grid-column: span 2;
        display: flex;
        gap: 5px;
      }
      select {
        flex: 1;
        background: #fff;
        color: #333;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      textarea {
        width: 100%;
        height: 70px;
        background: #fdfdfd;
        color: #333;
        border: 1px solid #ccc;
        resize: none;
        border-radius: 4px;
        margin-bottom: 10px;
        box-sizing: border-box;
        padding: 5px;
        font-family: monospace;
      }

      #splash {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-size: 4rem;
        font-family: "KaiTi", serif;
        font-weight: 900;
        color: var(--red-ink);
        text-shadow: 2px 2px 0 #fff;
        pointer-events: none;
        z-index: 200;
        opacity: 0;
        white-space: nowrap;
      }
      .pop {
        animation: popAnim 1.2s ease-out forwards;
      }
      @keyframes popAnim {
        0% {
          transform: translate(-50%, -50%) scale(0.5);
          opacity: 0;
        }
        20% {
          transform: translate(-50%, -50%) scale(1.2);
          opacity: 1;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="board-frame" id="boardFrame">
        <div class="board-inner">
          <svg class="grid" viewBox="0 0 450 500" preserveAspectRatio="none">
            <rect x="0" y="0" width="450" height="500" fill="var(--board-bg)" />
            <rect x="25" y="25" width="400" height="450" class="border" />
            <line x1="25" y1="75" x2="425" y2="75" class="line" />
            <line x1="25" y1="125" x2="425" y2="125" class="line" />
            <line x1="25" y1="175" x2="425" y2="175" class="line" />
            <line x1="25" y1="225" x2="425" y2="225" class="line" />
            <line x1="25" y1="275" x2="425" y2="275" class="line" />
            <line x1="25" y1="325" x2="425" y2="325" class="line" />
            <line x1="25" y1="375" x2="425" y2="375" class="line" />
            <line x1="25" y1="425" x2="425" y2="425" class="line" />
            <line x1="225" y1="25" x2="225" y2="225" class="line" />
            <line x1="225" y1="275" x2="225" y2="475" class="line" />
            <line x1="75" y1="25" x2="75" y2="225" class="line" />
            <line x1="75" y1="275" x2="75" y2="475" class="line" />
            <line x1="125" y1="25" x2="125" y2="225" class="line" />
            <line x1="125" y1="275" x2="125" y2="475" class="line" />
            <line x1="175" y1="25" x2="175" y2="225" class="line" />
            <line x1="175" y1="275" x2="175" y2="475" class="line" />
            <line x1="275" y1="25" x2="275" y2="225" class="line" />
            <line x1="275" y1="275" x2="275" y2="475" class="line" />
            <line x1="325" y1="25" x2="325" y2="225" class="line" />
            <line x1="325" y1="275" x2="325" y2="475" class="line" />
            <line x1="375" y1="25" x2="375" y2="225" class="line" />
            <line x1="375" y1="275" x2="375" y2="475" class="line" />
            <line x1="175" y1="25" x2="275" y2="125" class="line" />
            <line x1="275" y1="25" x2="175" y2="125" class="line" />
            <line x1="175" y1="375" x2="275" y2="475" class="line" />
            <line x1="275" y1="375" x2="175" y2="475" class="line" />
            <g class="markers">
              <path
                d="M72,118 v4 h-4 M78,118 v4 h4 M72,132 v-4 h-4 M78,132 v-4 h4"
                class="mark"
              />
              <path
                d="M372,118 v4 h-4 M378,118 v4 h4 M372,132 v-4 h-4 M378,132 v-4 h4"
                class="mark"
              />
              <path
                d="M72,368 v4 h-4 M78,368 v4 h4 M72,382 v-4 h-4 M78,382 v-4 h4"
                class="mark"
              />
              <path
                d="M372,368 v4 h-4 M378,368 v4 h4 M372,382 v-4 h-4 M378,382 v-4 h4"
                class="mark"
              />
              <path d="M28,168 v4 h4 M28,182 v-4 h4" class="mark" />
              <path
                d="M122,168 v4 h-4 M128,168 v4 h4 M122,182 v-4 h-4 M128,182 v-4 h4"
                class="mark"
              />
              <path
                d="M222,168 v4 h-4 M228,168 v4 h4 M222,182 v-4 h-4 M228,182 v-4 h4"
                class="mark"
              />
              <path
                d="M322,168 v4 h-4 M328,168 v4 h4 M322,182 v-4 h-4 M328,182 v-4 h4"
                class="mark"
              />
              <path d="M422,168 v4 h-4 M422,182 v-4 h-4" class="mark" />
              <path d="M28,318 v4 h4 M28,332 v-4 h4" class="mark" />
              <path
                d="M122,318 v4 h-4 M128,318 v4 h4 M122,332 v-4 h-4 M128,332 v-4 h4"
                class="mark"
              />
              <path
                d="M222,318 v4 h-4 M228,318 v4 h4 M222,332 v-4 h-4 M228,332 v-4 h4"
                class="mark"
              />
              <path
                d="M322,318 v4 h-4 M328,318 v4 h4 M322,332 v-4 h-4 M328,332 v-4 h4"
                class="mark"
              />
              <path d="M422,318 v4 h-4 M422,332 v-4 h-4" class="mark" />
            </g>
            <text x="110" y="250" class="river-text">楚 河</text>
            <g transform="translate(320, 230) scale(0.045)">
              <path
                fill="#AF3636"
                d="M77.1,590 C77,503.3 76.7,417.2 77.1,331 C77.2,289.2 83.4,248.3 101.8,210.1 C131.2,149.2 179.1,112.3 246.1,100.7 C258,98.7 269.9,97.7 281.9,97.7 465.2,97.8 648.5,97.6 831.8,97.9 871.2,98 908.8,106.6 942.9,127.2 987.4,154.1 1015.2,193.2 1027,243.7 1029.8,255.4 1031.1,267.3 1031.1,279.3 1031.1,435 1031.2,590.6 1030.9,746.3 1030.9,789.2 1022.1,830.1 999.2,867.2 974.8,906.7 939,928.9 894.4,938.1 882,940.6 869.4,941.2 856.7,941.2 702.8,941.1 549,941.4 395.2,940.9 354.6,940.8 317.2,928.7 286.8,900.7 251.7,868.4 231.2,827.8 224.1,780.5 222.5,769.8 222.1,759 222.1,748.1 222.2,686.5 222.2,624.8 222.1,563.2 222.1,551.8 222.9,540.5 224.1,529.3 224.5,526 225.8,525.2 228.9,525.2 259.2,525.3 289.5,525.4 319.9,525.2 324.4,525.2 324,527.5 324,530.5 324,604.1 323.9,677.8 324.1,751.5 324.2,775 330.5,796.8 346,815.2 358.5,830.1 374.5,838.9 394.1,839.1 431.9,839.5 469.7,839.4 507.6,839.4 615.9,839.4 724.2,839.4 832.5,839.4 843.5,839.4 854.5,839.7 865.5,839.4 889.9,838.7 906.7,826.6 917.2,805.3 925.9,787.5 928.7,768.2 930.2,748.7 931.8,727.2 931.1,705.7 931.1,684.2 931.2,555.2 931.2,426.2 931.1,297.3 931.1,280.9 930.1,264.5 923.1,249.4 911.1,223.2 889.3,209.5 862.3,202.8 852.7,200.5 842.9,199.6 833.1,199.6 648.2,199.7 463.4,199.8 278.6,199.5 235.1,199.4 201.1,227.1 188.1,269.1 182,289 179.1,309.4 179.1,330.1 179,472.6 179,615.1 179,757.6 179,769.1 178.9,780.6 178.9,792.1 178.6,821.2 187.2,848.1 199.6,874 211.2,898.3 227.8,918.3 250.2,933.4 251.6,934.4 253.4,935.1 253.9,937.2 252.2,938.4 250.3,937.9 248.6,937.9 215.3,938 181.9,938.1 148.6,938.1 144.3,938.1 140,937.6 135.7,937 131.6,936.5 128.2,934.6 125.3,931.6 106.6,912.6 95,889.5 87.4,864.4 80.1,840.6 76.7,816.4 76.8,791.5 77.1,724.5 77,657.5 77.1,590 z"
              />
              <path
                fill="#B13B3C"
                d="M877,396 C877,519.8 877,643.1 877,766.4 877,773.4 877,773.2 870.3,774.3 860.9,775.9 851.4,776.2 841.9,776.2 699.5,776.2 557,776.2 414.5,776.2 404.4,776.2 394.2,775.9 384.1,775.3 380.6,775 379.2,774 379,770.3 378.2,758.8 378.1,747.4 378.1,735.9 378.1,594.7 378.1,453.6 378.1,312.5 378.1,302.5 378.1,292.5 378.8,282.5 379.1,279 380.3,278.5 383.2,278.5 407.5,278.4 431.9,277.9 456.2,277.9 576.5,277.8 696.8,277.8 817.1,277.8 833.6,277.8 850.1,276.9 866.6,278.6 877.1,279.6 877.2,279.5 877.2,290 877.1,325.2 877.1,360.3 877,396 z"
              />
              <path
                fill="#B03637"
                d="M267.8,382.3 C250,374.7 238.6,362.2 234.9,343.3 230.6,321.2 240.8,291.3 271.6,281.6 296,273.8 333.2,288.6 339.1,323 342.8,344.7 331,369.1 310.6,379.7 296.7,387 282.7,387.7 267.8,382.3 z"
              />
              <path
                fill="#FDFCFC"
                d="M536,289.5 C562.7,289.7 588.8,288.6 615,289.7 619.7,289.9 621.5,290.8 621.5,296.1 621.7,364.4 621.9,432.7 621.4,501 621.3,503 622.4,505.7 620.6,506.6 618.6,507.7 616.7,505.4 614.9,504.3 607.7,499.7 601.6,493.7 595.6,487.7 538.8,430.7 482,373.7 425.1,316.7 416.8,308.4 408.3,300.1 400.2,290.1 445.9,288.4 490.7,289.8 536,289.5 z"
              />
              <path
                fill="#FDFDFD"
                d="M402.8,765 C399.7,763.3 402.3,762.2 403,761.3 408.7,755 414.3,748.6 420.3,742.6 473.1,689.8 525.9,637.1 578.7,584.4 586.8,576.3 594.8,567.9 602.9,559.8 607.4,555.4 612.4,551.5 618,548.4 620.2,547.1 621.4,547.4 621.4,550.2 621.4,551.6 621.4,552.9 621.4,554.2 621.5,608 621.5,661.8 621.6,715.7 621.6,730 621.5,744.3 621.8,758.6 622,763.5 620.8,765.1 615.6,765.1 544.8,764.9 474,765 402.8,765 z"
              />
              <path
                fill="#FEFDFD"
                d="M634,318 C634.1,309.7 634.5,301.8 634.4,294 634.3,290.6 635.7,289.8 638.8,289.8 676.6,289.7 714.4,288.8 752.3,289.2 784.3,289.5 816.3,289.4 848.3,289.6 849.8,289.6 852.1,288.7 852.8,290.3 853.7,292 851.5,293 850.4,294.2 834.3,312.4 817.2,329.7 799.7,346.6 757.2,387.3 716.5,429.8 674.3,470.8 663,481.7 652.9,493.7 640.5,503.3 639.6,504.1 638.7,504.8 637.7,505.4 636.7,506 636,507.4 634.7,506.7 633.5,506 634.1,504.6 634.1,503.5 634,485 633.9,466.5 633.9,448 633.9,404.8 634,361.7 634,318 z"
              />
              <path
                fill="#FEFDFD"
                d="M828.5,737.5 C836,744.6 842.8,752 848.7,760.1 849.6,761.4 851.6,762.5 850.6,764.3 849.9,765.7 847.9,764.9 846.5,764.9 800.3,765 754.2,765.1 708,765.2 685.7,765.2 663.4,765 641.1,765.3 636.3,765.3 634.9,764 634.7,759.2 632.7,711.6 634.5,664 633.9,616.3 633.7,594.3 633.3,572.3 634.8,550.4 634.9,549.4 635,548.5 635.1,546.8 640.9,550.9 645.7,555.2 650.3,559.7 694.1,603.5 737.9,647.4 781.7,691.2 797.1,706.6 812.7,721.9 828.5,737.5 z"
              />
              <path
                fill="#FEFDFD"
                d="M517,520.9 C476.4,520.8 436.2,521.4 396.1,520.6 392.9,520.5 391,520.5 390.9,516.2 390.6,446.2 390.6,376.3 391.1,306.3 391.1,305.6 391.1,305 391.2,304.1 393.5,303.8 394.8,305.6 396.3,306.7 401.6,310.7 406.5,315.3 411,320.2 435.7,347.1 462.6,371.7 488.2,397.8 526.8,437.1 567,474.8 605.8,514.1 606,514.3 606.3,514.5 606.5,514.8 607.6,516.3 610.5,517.3 609.8,519.2 609.1,521.3 606.3,520.2 604.4,520.3 575.5,522 546.5,520.5 517,520.9 z"
              />
              <path
                fill="#FDFDFD"
                d="M661.4,501.4 C685.6,477.3 709.6,453.4 733.5,429.5 770.5,392.5 807.5,355.5 844.4,318.4 848.4,314.4 853.2,312 858,309.3 860.3,308 861.2,308.6 861.3,311.3 861.5,317.6 862.1,323.9 862.1,330.2 862.2,386.2 862.2,442.2 862.1,498.2 862.1,504.3 861.4,510.5 861.4,516.6 861.4,519.8 860.1,520.5 857.2,520.5 850.7,520.5 844.2,520.9 837.7,520.9 783.8,521 729.8,521 675.8,521.1 666.4,521.1 656.9,521.1 646.1,521.1 650.9,512.8 656.1,507.3 661.4,501.4 z"
              />
              <path
                fill="#FEFDFD"
                d="M864.3,678 C864.3,701 864.3,723.5 864.2,746 864.2,747.3 865.1,749.3 863.3,750 862.1,750.5 861,749.1 859.9,748.4 853.8,744.5 848.2,740.1 843.1,735 784.2,676.1 725.3,617.2 666.5,558.2 660.8,552.6 655.5,546.6 650.1,540.7 649.3,539.8 647.7,538.8 648.4,537.4 649.1,536 650.8,536.7 652,536.6 677.2,535.5 702.3,536.1 727.5,536.2 755.9,536.2 784.4,535.9 812.9,536 828.4,536 843.9,536.6 859.4,536.8 863.3,536.8 864.3,538.2 864.3,542.1 864.2,587.2 864.3,632.4 864.3,678 z"
              />
              <path
                fill="#FEFDFD"
                d="M591.6,536.3 C595.9,536.4 599.7,536.4 603.6,536.6 604.3,536.6 605.4,536.7 605.8,537.2 606.6,538.2 605.4,539 604.8,539.6 599.4,545.5 594.1,551.6 588.4,557.1 539.3,604.6 492.3,654.3 443,701.6 431.3,712.8 420.2,724.5 409.5,736.7 404.3,742.5 398.5,747.7 392.3,753.1 390.8,749.4 391.1,746 391.1,742.8 391,678.5 391,614.1 391,549.8 391,536.2 391.2,536 405.1,536 462.3,536 519.5,536.1 576.6,536.1 581.5,536.1 586.3,536.2 591.6,536.3 z"
              />
            </g>
          </svg>
          <div id="markerLayer" class="layer"></div>
          <div id="pieceLayer" class="layer"></div>
          <div class="click-mask" onclick="ui.click(event)"></div>
          <div id="splash">將 軍</div>
        </div>
      </div>

      <div class="ui-panel">
        <div class="tabs">
          <div
            class="tab active"
            data-key="tabGame"
            onclick="ui.switchTab('game')"
          >
            Game
          </div>
          <div class="tab" data-key="tabTools" onclick="ui.switchTab('tools')">
            Tools
          </div>
        </div>

        <div id="tab-game" class="tab-content active">
          <div id="status" class="status">Red to Move</div>

          <div id="branchCtrl" class="branch-ctrl">
            <button class="branch-btn" onclick="game.prevVar()">&lt;</button>
            <span id="varInfo">Var: 1/1</span>
            <button class="branch-btn" onclick="game.nextVar()">&gt;</button>
          </div>

          <div class="playback-bar">
            <button class="pb-btn" onclick="game.goto(0)">|&lt;</button>
            <button class="pb-btn" onclick="game.step(-1)">&lt;</button>
            <button class="pb-btn" id="playBtn" onclick="game.togglePlay()">
              ▶
            </button>
            <button class="pb-btn" onclick="game.step(1)">&gt;</button>
            <button class="pb-btn" onclick="game.goto(9999)">&gt;|</button>
          </div>
          <div id="history" class="history"></div>
        </div>

        <div id="tab-tools" class="tab-content">
          <div class="tool-grid">
            <button
              class="btn btn-red"
              data-key="newGame"
              onclick="game.newGame()"
            >
              New Game
            </button>
            <button class="btn btn-norm" data-key="undo" onclick="game.undo()">
              Undo
            </button>
            <button class="btn btn-norm" data-key="flip" onclick="ui.doFlip()">
              Flip View
            </button>
            <button
              class="btn btn-norm"
              data-key="reflect"
              onclick="ui.doReflect()"
            >
              Reflect
            </button>
          </div>
          <hr
            style="
              border: 0;
              border-top: 1px solid rgba(255, 255, 255, 0.1);
              margin: 10px 0;
            "
          />
          <textarea
            id="fenBox"
            placeholder="Paste FEN or Movelist..."
          ></textarea>

          <div class="tool-grid">
            <button class="btn btn-norm" data-key="load" onclick="game.load()">
              Paste Load
            </button>
          </div>

          <div
            style="
              margin-top: 10px;
              color: #555;
              font-size: 12px;
              margin-bottom: 5px;
            "
          >
            Export Format:
          </div>
          <div class="export-row">
            <select id="exportFormat">
              <option value="dpxq">DhtmlXQ</option>
              <option value="text">Text (CN)</option>
            </select>
            <button
              class="btn btn-green"
              data-key="export"
              onclick="game.export()"
            >
              Export
            </button>
          </div>
          <div class="tool-grid" style="margin-top: 8px">
            <button
              class="btn btn-norm"
              onclick="ui.toggleLang()"
              style="grid-column: span 2"
            >
              文 / A
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
